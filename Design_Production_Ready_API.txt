------------------------------------------------------------
üß© API DESIGN FOUNDATION (START SIMPLE)
------------------------------------------------------------

Future me, don‚Äôt overthink this.

Every good API starts with answering ONE question:

üëâ ‚ÄúWhat does my data look like?‚Äù

That‚Äôs it.

And for that, we use **Zod**.

Not because it‚Äôs fancy ‚Äî
but because it does three jobs at once.

------------------------------------------------------------
üßæ STEP 1: DEFINE THE DATA (TODO MODEL)
------------------------------------------------------------

Let‚Äôs take a simple example: a Todo.

A Todo has:

‚Ä¢ title        ‚Üí string (must exist)
‚Ä¢ description  ‚Üí string (optional, can be null)
‚Ä¢ isCompleted  ‚Üí boolean (optional, default: false)

That‚Äôs the *truth* of the data.

Nothing else matters until this is clear.

------------------------------------------------------------
ü§î WHY ZOD (IN PLAIN WORDS)
------------------------------------------------------------

Zod gives me:

‚úî Runtime validation (bad data never enters)
‚úî TypeScript types (no duplication)
‚úî OpenAPI support (docs come for free)

So instead of writing:
‚Ä¢ types
‚Ä¢ validators
‚Ä¢ docs

I write **one schema**.

Mindset reminder:
> Define the shape first.  
> Everything else follows.

------------------------------------------------------------
üîÅ STEP 2: GET TYPES FOR FREE
------------------------------------------------------------

Once the Zod schema exists:

‚Ä¢ TypeScript types are auto-generated
‚Ä¢ No manual syncing
‚Ä¢ No ‚Äúthis type doesn‚Äôt match prod‚Äù bugs

Rule:
> Never write the same type twice.

If schema changes ‚Üí types change automatically.

------------------------------------------------------------
üì§ STEP 3: DEFINE INPUT & OUTPUT (CLEAR CONTRACTS)
------------------------------------------------------------

Now think like a consumer of your API.

Example: ‚ÄúGet all todos‚Äù

Ask two questions:

1Ô∏è‚É£ What input does it need?
‚Üí Nothing

2Ô∏è‚É£ What does it return?
‚Üí A list of todos

So the contract becomes:

‚Ä¢ Input: undefined  
‚Ä¢ Output:
  {
    todos: Todo[]
  }

Simple.
Readable.
Unambiguous.

------------------------------------------------------------
üß≠ STEP 4: GROUP LOGIC USING tRPC ROUTERS
------------------------------------------------------------

Now we organize endpoints.

Use **tRPC routers** to group related actions.

Example: todo router

Inside it:
‚Ä¢ getAllTodos ‚Üí query
‚Ä¢ createTodo  ‚Üí mutation

This gives:
‚úî Type safety end-to-end
‚úî Shared contracts
‚úî No frontend/backend mismatch

Everything lives under:
    /trpc

------------------------------------------------------------
üåê STEP 5: REMEMBER ‚Äî tRPC IS NOT A SERVER
------------------------------------------------------------

Important reminder for future me:

tRPC does NOT listen on a port.

It must be mounted.

So we do this:

‚Ä¢ Create Express app
‚Ä¢ Add tRPC Express adapter
‚Ä¢ Create context (even empty is fine)
‚Ä¢ Mount appRouter

Only now the API is actually reachable.

------------------------------------------------------------
üìú STEP 6: OPENAPI (THIS IS WHERE MAGIC HAPPENS)
------------------------------------------------------------

Now comes the real power move.

Install:
    trpc-to-openapi

Why this matters:

‚Ä¢ APIs become self-documenting
‚Ä¢ Frontend doesn‚Äôt guess endpoints
‚Ä¢ Postman / Requestly works instantly

No manual docs.
No drift.

------------------------------------------------------------
üè∑Ô∏è STEP 7: DESCRIBE EACH ROUTE (OPENAPI META)
------------------------------------------------------------

For every endpoint, add metadata:

‚Ä¢ HTTP method (GET / POST)
‚Ä¢ URL path (/todos)
‚Ä¢ Tags (grouping)
‚Ä¢ Description (human readable)

Think of this as:
> Writing docs while coding ‚Äî once.

------------------------------------------------------------
üìÑ STEP 8: GENERATE OPENAPI JSON
------------------------------------------------------------

From the appRouter, generate:

‚Ä¢ OpenAPI JSON
‚Ä¢ With title, version, base URL

This becomes the **official API contract**.

------------------------------------------------------------
üö™ STEP 9: SERVE THE SPEC
------------------------------------------------------------

Expose it using Express:

    GET /openapi.json

Now:
‚Ä¢ Tools can import it
‚Ä¢ Humans can inspect it
‚Ä¢ Frontend can trust it

------------------------------------------------------------
üîå STEP 10: MOUNT OPENAPI ROUTES
------------------------------------------------------------

Mount OpenAPI middleware at:

    /api

Result:

‚Ä¢ REST clients can call APIs
‚Ä¢ tRPC clients still work
‚Ä¢ Same validation everywhere

One backend.
Many consumers.

------------------------------------------------------------
‚ûï STEP 11: ADD NEW ENDPOINTS WITHOUT FEAR
------------------------------------------------------------

Example: Create Todo

You only do four things:

‚Ä¢ Define input schema
‚Ä¢ Define output schema
‚Ä¢ Add OpenAPI metadata
‚Ä¢ Write business logic

That‚Äôs it.

Docs update automatically.
Validation is automatic.

------------------------------------------------------------
üõ°Ô∏è WHY THIS IS SAFE BY DEFAULT
------------------------------------------------------------

If someone sends wrong input:

‚ùå Request rejected early  
‚ùå Business logic untouched  

Zod blocks bad data at the door.

------------------------------------------------------------
üß™ TESTING & FRONTEND USAGE
------------------------------------------------------------

Using Postman / Requestly:

‚Ä¢ Import openapi.json
‚Ä¢ Routes appear automatically
‚Ä¢ Request bodies are prefilled
‚Ä¢ Types are visible

Frontend developers:
‚Ä¢ Use OpenAPI spec
‚Ä¢ Generate types
‚Ä¢ Build with confidence

------------------------------------------------------------
üß† WHY ALL THIS IS WORTH IT
------------------------------------------------------------

This setup gives:

‚úî Runtime validation  
‚úî Compile-time safety  
‚úî Automatic documentation  
‚úî Fewer bugs  
‚úî Faster teams  

Yes, setup feels heavy ONCE.

After that?

üëâ You only think about business logic.

------------------------------------------------------------
üß† FINAL NOTE TO FUTURE ME
------------------------------------------------------------

If you ever think:
‚ÄúLet‚Äôs just quickly write an endpoint‚Ä¶‚Äù

Stop.

You already built the system.
Use it.
Trust it.

‚Äî You, saving your own time ‚ù§Ô∏è
============================================================
